### Solution {.tabset}

#### R

a. Quantiles
```{r}

quartiles.indep <- cbind(quantile(y.obs.indep[,1], probs = c(0.25,0.75)),
                         quantile(y.obs.indep[,2], probs = c(0.25,0.75)))
                                        # Or with `apply`:
quartiles.indep <- apply(y.obs.indep, MARGIN=2, FUN=quantile, probs=c(0.25,0.75))

                                        # then we use apply
quartiles.dep <- apply(y.obs.dep, MARGIN=2, FUN=quantile, probs=c(0.25,0.75))
quant5_95.indep <- apply(y.obs.indep, MARGIN=2, FUN=quantile, probs=c(0.05,0.95))
quant5_95.dep <- apply(y.obs.dep, MARGIN=2, FUN=quantile, probs=c(0.05,0.95))
cat("Interquartile range\nIndep: ", diff(quartiles.indep),
    "\nDep: ", diff(quartiles.dep), "\n")

```

b. Histograms and densities

```{r}
par(mfrow=c(2,2))
hist(y.obs.indep[,1], main="y1 of y.indep")
hist(y.obs.indep[,2], main="y2 of y.indep")
hist(y.obs.dep[,1],   main="y1 of y.dep")
hist(y.obs.dep[,2],   main="y2 of y.dep")

par(mfrow=c(2,2))
plot(density(y.obs.indep[,1]), main="y1 of y.indep")
plot(density(y.obs.indep[,2]), main="y2 of y.indep")
plot(density(y.obs.dep[,1]),   main="y1 of y.dep")
plot(density(y.obs.dep[,2]),   main="y2 of y.dep")

```

c. Scatterplots

```{r}

plot(y.obs.indep, main="y.obs.indep")
plot(y.obs.dep, main="y.obs.dep")

```

d. Covariance and correlation
```{r}

covariance.indep <- cov(y.obs.indep)
covariance.dep <- cov(y.obs.dep)
correlation.indep <- cor(y.obs.indep)
correlation.dep <- cor(y.obs.dep)

```

#### Julia
a. Quantiles
```{julia, results = 'hide'}
using StatsBase

interquartiles_indep = [iqr(Y_indep_sample[1, :]) iqr(Y_indep_sample[2, :])]

interquartiles_dep = [iqr(Y_dep_sample[1, :]) iqr(Y_dep_sample[2, :])]

inter_5_95_quantile_indep = [percentile(Y_indep_sample[1, :], 95)-percentile(Y_indep_sample[1, :], 5) 
percentile(Y_indep_sample[2, :], 95)-percentile(Y_indep_sample[2, :], 5)]'

inter_5_95_quantile_dep = [percentile(Y_dep_sample[1, :], 95)-percentile(Y_dep_sample[1, :], 5) 
percentile(Y_dep_sample[2, :], 95)-percentile(Y_dep_sample[2, :], 5)]'
```

b. Histograms and densities
```{julia, results = 'hide'}
hist = [
histogram(Y_indep_sample[1, :], nbins = 15, 
    xlabel="Y_1_indep sample", 
    title="Y_1 of Y_indep"),
histogram(Y_indep_sample[2, :], nbins = 15, 
    xlabel="Y_2_indep sample", 
    title="Y_2 of Y_indep"),
histogram(Y_dep_sample[1, :], nbins = 15, 
    xlabel="Y_1_dep sample", 
    title="Y_1 of Y_dep"),
histogram(Y_dep_sample[2, :], nbins = 15, 
    xlabel="Y_2_dep sample", 
    title="Y_2 of Y_dep")
]
```
```{julia}
plot(hist..., legend = false, ylabel = "Frequency")
```
```{julia, results = 'hide'}
using StatsPlots
dens = [
density(Y_indep_sample[1,:],
    xlabel="N=1000", 
    title="Y_1 of Y_indep"),
density(Y_indep_sample[2,:],
    xlabel="N=1000", 
    title="Y_2 of Y_indep"),
density(Y_dep_sample[1,:],
    xlabel="N=1000", 
    title="Y_1 of Y_dep"),
density(Y_dep_sample[2,:],
    xlabel="N=1000", 
    title="Y_2 of Y_dep")
]
```
```{julia}
plot(dens..., lengend = false, ylabel = "Density")
```

Note that it is sometimes easier to make a loop instead of explicitely writing severals times the histogram and density plots. We will see examples of such loops later.


c. Scatterplots

```{julia}
scatter(Y_indep_sample[1, :], Y_indep_sample[2, :],
    labels=false, 
    xlabel="Y_indep_sample 1", 
    ylabel="Y_indep_sample 2", 
    title="Y_indep_sample")
scatter(Y_dep_sample[1, :], Y_dep_sample[2, :],
    labels=false, 
    xlabel="Y_dep_sample 1", 
    ylabel="Y_dep_sample 2", 
    title="Y_dep_sample")
```

d. Covariance and correlation
```{julia}
using Statistics
Statistics.cov(Y_indep_sample, dims=2)
Statistics.cov(Y_dep_sample, dims=2)
Statistics.cor(Y_indep_sample, dims=2)
Statistics.cor(Y_dep_sample, dims=2)
```
